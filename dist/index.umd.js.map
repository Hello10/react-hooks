{"version":3,"file":"index.umd.js","sources":["../src/useAnimationFrame.js","../src/useSingleton.js","../src/useStateBlob.js"],"sourcesContent":["import React, {useRef} from 'react';\n\nconst {requestAnimationFrame, cancelAnimationFrame} = window;\n\nexport default function useAnimationFrame (callback) {\n  const request = useRef();\n  const last_time = useRef();\n  const first_time = useRef();\n\n  function animate (time) {\n    let first = first_time.current;\n    if (first === undefined) {\n      first_time.current = time;\n      first = time;\n    }\n\n    const last = last_time.current;\n    if (last !== undefined) {\n      const delta = time - last;\n      const total = time - first;\n      callback({delta, total});\n    }\n\n    last_time.current = time;\n    request.current = requestAnimationFrame(animate);\n  }\n\n  React.useEffect(()=> {\n    request.current = requestAnimationFrame(animate);\n    return ()=> cancelAnimationFrame(request.current);\n  }, []);\n}\n","import React from 'react';\n\nclass Singleton {\n  static use (initial) {\n    console.log('use!');\n    if (!this.instance) {\n      this.instance = new this(initial || {});\n    }\n    const {instance} = this;\n    const [, setState] = React.useState();\n    React.useEffect(()=> {\n      instance.addListener(setState);\n      return ()=> {\n        instance.removeListener(setState);\n      };\n    }, []);\n    return instance;\n  }\n\n  constructor (initial) {\n    if (this.constructor.instance) {\n      throw new Error(\"Don't call singleton constructor directly\");\n    }\n    if (initial.constructor === Function) {\n      initial = initial();\n    }\n    this.state = this.initialize(initial);\n    this.listeners = [];\n  }\n\n  initialize (state) {\n    return state;\n  }\n\n  setState (state) {\n    this.state = {\n      ...this.state,\n      ...state\n    };\n\n    for (const setState of this.listeners) {\n      setState(this.state);\n    }\n  }\n\n  addListener (listener) {\n    this.listeners.push(listener);\n  }\n\n  removeListener (listener) {\n    this.listeners = this.listeners.filter((l)=> l !== listener);\n  }\n}\n\nexport default function useSingleton (Class, initial) {\n  return Class.use(initial);\n}\nuseSingleton.Singleton = Singleton;\n","import {useReducer} from 'react';\n\nexport default function useStateBlob (initial) {\n  return useReducer((state, delta)=> {\n    return {\n      ...state,\n      ...delta\n    };\n  }, initial);\n}\n"],"names":["requestAnimationFrame","cancelAnimationFrame","window","useAnimationFrame","callback","request","useRef","last_time","first_time","animate","time","first","current","undefined","last","delta","total","React","useEffect","Singleton","use","initial","console","log","instance","setState","useState","addListener","removeListener","constructor","Error","Function","state","initialize","listeners","listener","push","filter","l","useSingleton","Class","useStateBlob","useReducer"],"mappings":";;;;;;;EAEA,MAAM;EAACA,EAAAA,qBAAD;EAAwBC,EAAAA;EAAxB,IAAgDC,MAAtD;EAEe,SAASC,iBAAT,CAA4BC,QAA5B,EAAsC;EACnD,QAAMC,OAAO,GAAGC,YAAM,EAAtB;EACA,QAAMC,SAAS,GAAGD,YAAM,EAAxB;EACA,QAAME,UAAU,GAAGF,YAAM,EAAzB;;EAEA,WAASG,OAAT,CAAkBC,IAAlB,EAAwB;EACtB,QAAIC,KAAK,GAAGH,UAAU,CAACI,OAAvB;;EACA,QAAID,KAAK,KAAKE,SAAd,EAAyB;EACvBL,MAAAA,UAAU,CAACI,OAAX,GAAqBF,IAArB;EACAC,MAAAA,KAAK,GAAGD,IAAR;EACD;;EAED,UAAMI,IAAI,GAAGP,SAAS,CAACK,OAAvB;;EACA,QAAIE,IAAI,KAAKD,SAAb,EAAwB;EACtB,YAAME,KAAK,GAAGL,IAAI,GAAGI,IAArB;EACA,YAAME,KAAK,GAAGN,IAAI,GAAGC,KAArB;EACAP,MAAAA,QAAQ,CAAC;EAACW,QAAAA,KAAD;EAAQC,QAAAA;EAAR,OAAD,CAAR;EACD;;EAEDT,IAAAA,SAAS,CAACK,OAAV,GAAoBF,IAApB;EACAL,IAAAA,OAAO,CAACO,OAAR,GAAkBZ,qBAAqB,CAACS,OAAD,CAAvC;EACD;;EAEDQ,EAAAA,cAAK,CAACC,SAAN,CAAgB,MAAK;EACnBb,IAAAA,OAAO,CAACO,OAAR,GAAkBZ,qBAAqB,CAACS,OAAD,CAAvC;EACA,WAAO,MAAKR,oBAAoB,CAACI,OAAO,CAACO,OAAT,CAAhC;EACD,GAHD,EAGG,EAHH;EAID;;;;;;;;;;;;;;;;;;;;EC7BD,MAAMO,SAAN,CAAgB;EACd,SAAOC,GAAP,CAAYC,OAAZ,EAAqB;EACnBC,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;;EACA,QAAI,CAAC,KAAKC,QAAV,EAAoB;EAClB,WAAKA,QAAL,GAAgB,IAAI,IAAJ,CAASH,OAAO,IAAI,EAApB,CAAhB;EACD;;EACD,UAAM;EAACG,MAAAA;EAAD,QAAa,IAAnB;EACA,UAAM,GAAGC,QAAH,IAAeR,cAAK,CAACS,QAAN,EAArB;EACAT,IAAAA,cAAK,CAACC,SAAN,CAAgB,MAAK;EACnBM,MAAAA,QAAQ,CAACG,WAAT,CAAqBF,QAArB;EACA,aAAO,MAAK;EACVD,QAAAA,QAAQ,CAACI,cAAT,CAAwBH,QAAxB;EACD,OAFD;EAGD,KALD,EAKG,EALH;EAMA,WAAOD,QAAP;EACD;;EAEDK,EAAAA,WAAW,CAAER,OAAF,EAAW;EACpB,QAAI,KAAKQ,WAAL,CAAiBL,QAArB,EAA+B;EAC7B,YAAM,IAAIM,KAAJ,CAAU,2CAAV,CAAN;EACD;;EACD,QAAIT,OAAO,CAACQ,WAAR,KAAwBE,QAA5B,EAAsC;EACpCV,MAAAA,OAAO,GAAGA,OAAO,EAAjB;EACD;;EACD,SAAKW,KAAL,GAAa,KAAKC,UAAL,CAAgBZ,OAAhB,CAAb;EACA,SAAKa,SAAL,GAAiB,EAAjB;EACD;;EAEDD,EAAAA,UAAU,CAAED,KAAF,EAAS;EACjB,WAAOA,KAAP;EACD;;EAEDP,EAAAA,QAAQ,CAAEO,KAAF,EAAS;EACf,SAAKA,KAAL,gBACK,KAAKA,KADV,EAEKA,KAFL;;EAKA,SAAK,MAAMP,QAAX,IAAuB,KAAKS,SAA5B,EAAuC;EACrCT,MAAAA,QAAQ,CAAC,KAAKO,KAAN,CAAR;EACD;EACF;;EAEDL,EAAAA,WAAW,CAAEQ,QAAF,EAAY;EACrB,SAAKD,SAAL,CAAeE,IAAf,CAAoBD,QAApB;EACD;;EAEDP,EAAAA,cAAc,CAAEO,QAAF,EAAY;EACxB,SAAKD,SAAL,GAAiB,KAAKA,SAAL,CAAeG,MAAf,CAAuBC,CAAD,IAAMA,CAAC,KAAKH,QAAlC,CAAjB;EACD;;EAjDa;;AAoDhB,EAAe,SAASI,YAAT,CAAuBC,KAAvB,EAA8BnB,OAA9B,EAAuC;EACpD,SAAOmB,KAAK,CAACpB,GAAN,CAAUC,OAAV,CAAP;EACD;EACDkB,YAAY,CAACpB,SAAb,GAAyBA,SAAzB;;ECvDe,SAASsB,YAAT,CAAuBpB,OAAvB,EAAgC;EAC7C,SAAOqB,gBAAU,CAAC,CAACV,KAAD,EAAQjB,KAAR,KAAiB;EACjC,wBACKiB,KADL,EAEKjB,KAFL;EAID,GALgB,EAKdM,OALc,CAAjB;EAMD;;;;;;;;;;"}